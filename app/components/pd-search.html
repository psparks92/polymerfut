<dom-module id="pd-search">
    <template>
        <link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html"/>
        <link rel="import" href="../../bower_components/iron-input/iron-input.html"/>
        <link rel="import" href="../pages/player-card/player-card.html"/>
        <input type="text" on-input="fireSearchRequest" is="iron-input" bind-value="{{searchStr}}"/>
        <template is="dom-repeat" items="{{players}}">
            <span>{{item.firstName}},{{item.id}}</span>
        <player-card id="9041"></player-card>
        </template>
        <iron-ajax id="searchPlayersRequest" method="GET" handle-as="json" on-response="populateList"></iron-ajax>
    </template>

</dom-module>
<script>
    Polymer({
        is: "pd-search",
        properties: {
            searchStr: String,
            players: Array
        },
        fireSearchRequest: function () {
            if (this.searchStr.length > 2) {
                var self = this;
                self.$.searchPlayersRequest.url = "http://peterfutapi.azurewebsites.net/players/search/" + self.searchStr;
                self.$.searchPlayersRequest.generateRequest();
            }
        },
        populateList: function (response) {
            this.players = response.detail.response;
        }
    });
</script>